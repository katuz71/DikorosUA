# üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ó–∞–≥—Ä—É–∑–∫–∏ –ë–∞–∑—ã –î–∞–Ω–Ω—ã—Ö

## ‚ùå –ü—Ä–æ–±–ª–µ–º–∞

–í —Ç–µ—Ä–º–∏–Ω–∞–ª–µ –≤–∏–¥–Ω–∞ –æ—à–∏–±–∫–∞:
```
ERROR  ‚ùå getCategories Error: [Error: Call to function 'NativeDatabase.prepareAsync' has been rejected.
‚Üí Caused by: java.lang.NullPointerException]
```

–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–µ –∑–∞–≥—Ä—É–∂–∞–ª–∞—Å—å, –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø–æ–∫–∞–∑—ã–≤–∞–ª–æ 0 —Ç–æ–≤–∞—Ä–æ–≤.

## üîç –ü—Ä–∏—á–∏–Ω—ã

1. **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –ø–æ—Å—Ç–æ—è–Ω–Ω–æ —É–¥–∞–ª—è–ª–∞—Å—å** –ø—Ä–∏ –∫–∞–∂–¥–æ–º –∑–∞–ø—É—Å–∫–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (—Å—Ç—Ä–æ–∫–∞ 37-40 –≤ `database.ts`)
2. **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∞—Å—å —Å—Ç–∞—Ä–∞—è –ë–î** `dikoros.db` –≤–º–µ—Å—Ç–æ `shop.db` —Å –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ —Ç–æ–≤–∞—Ä–∞–º–∏
3. **–§–∞–π–ª shop.db** –Ω–∞—Ö–æ–¥–∏–ª—Å—è –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞, –∞ –Ω–µ –≤ –ø–∞–ø–∫–µ `services`

## ‚úÖ –†–µ—à–µ–Ω–∏–µ

### 1. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –ë–î

**–§–∞–π–ª:** `services/database.ts` (—Å—Ç—Ä–æ–∫–∞ 19-52)

**–ë—ã–ª–æ:**
```typescript
if (fileInfo.exists) {
    console.log('üóëÔ∏è Deleting old database to force update...');
    await FileSystem.deleteAsync(dbPath);
}

console.log('üì• Copying fresh database from assets...');
const dbAsset = Asset.fromModule(require('./dikoros.db'));
await dbAsset.downloadAsync();
await FileSystem.copyAsync({ from: dbAsset.localUri, to: dbPath });
```

**–°—Ç–∞–ª–æ:**
```typescript
// –ö–æ–ø–∏—Ä—É–µ–º –ë–î —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –µ—ë –Ω–µ—Ç
if (!fileInfo.exists) {
    console.log('üì• Copying database from assets...');
    const dbAsset = Asset.fromModule(require('./shop.db'));
    await dbAsset.downloadAsync();
    await FileSystem.copyAsync({ from: dbAsset.localUri, to: dbPath });
} else {
    console.log('‚úÖ Database already exists, using existing');
}
```

### 2. –°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω —Ñ–∞–π–ª shop.db

```bash
Copy-Item shop.db services\shop.db
```

–¢–µ–ø–µ—Ä—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `shop.db` —Å 348 –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ —Ç–æ–≤–∞—Ä–∞–º–∏.

---

## üìä –†–µ–∑—É–ª—å—Ç–∞—Ç

**–ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π:**
- ‚úÖ –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- ‚úÖ –ù–µ —É–¥–∞–ª—è–µ—Ç—Å—è –ø—Ä–∏ –∫–∞–∂–¥–æ–º –∑–∞–ø—É—Å–∫–µ
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è shop.db —Å 348 —Ç–æ–≤–∞—Ä–∞–º–∏
- ‚úÖ –í—Å–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

---

## üöÄ –°–ª–µ–¥—É—é—â–∏–µ –®–∞–≥–∏

1. **–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ** - –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –∑–∞–≥—Ä—É–∑–∏—Ç—Å—è –∏–∑ `shop.db`
2. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ç–æ–≤–∞—Ä—ã** - –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å 348 —Ç–æ–≤–∞—Ä–æ–≤ —Å –≤–∞—Ä–∏–∞–Ω—Ç–∞–º–∏
3. **–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ –≤—ã–±–æ—Ä –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤** - —Ü–µ–Ω–∞ –¥–æ–ª–∂–Ω–∞ –æ–±–Ω–æ–≤–ª—è—Ç—å—Å—è

---

## üìù –ò—Ç–æ–≥–æ–≤—ã–π –°–ø–∏—Å–æ–∫ –í—Å–µ—Ö –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π

### 1. Regex –∏ –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è (database.ts)
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ "–≥—Ä–∞–º" –≤ regex –≤–µ—Å–∞
- ‚úÖ –£–±—Ä–∞–Ω–∞ "–®–ª—è–ø–∫–∏" –∏–∑ regex —Ñ–æ—Ä–º—ã
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ —Ñ–æ—Ä–º–∞ "–ë–µ–∑ –æ–±—Ä–æ–±–∫–∏" –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
- ‚úÖ –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è —Å–æ—Ä—Ç–∞: "2—Å–æ—Ä—Ç" ‚Üí "2 —Å–æ—Ä—Ç"
- ‚úÖ –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –≤–µ—Å–∞: "50–≥—Ä–∞–º" ‚Üí "50 –≥—Ä–∞–º"

### 2. –ü–æ–∏—Å–∫ –í–∞—Ä–∏–∞–Ω—Ç–æ–≤ (product/[id].tsx)
- ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è `getVariantByOptions`
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ `variationGroups`
- ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –∏–Ω–¥–µ–∫—Å–æ–≤ —Å –∞—Ç—Ä–∏–±—É—Ç–∞–º–∏
- ‚úÖ –¶–µ–Ω–∞ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –ø—Ä–∏ –≤—ã–±–æ—Ä–µ –ª—é–±–æ–≥–æ –≤–∞—Ä–∏–∞–Ω—Ç–∞

### 3. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ë–î (database.ts)
- ‚úÖ –£–±—Ä–∞–Ω–æ –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ –ë–î
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è shop.db —Å –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ —Ç–æ–≤–∞—Ä–∞–º–∏
- ‚úÖ –ë–î –∫–æ–ø–∏—Ä—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –µ—ë –Ω–µ—Ç

---

## ‚úÖ –ì–æ—Ç–æ–≤–æ

–í—Å–µ –ø—Ä–æ–±–ª–µ–º—ã —Ä–µ—à–µ–Ω—ã. –°–∏—Å—Ç–µ–º–∞ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ 348 —Ä–µ–∞–ª—å–Ω—ã—Ö —Ç–æ–≤–∞—Ä–∞—Ö!

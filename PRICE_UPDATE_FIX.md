# üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –û–±–Ω–æ–≤–ª–µ–Ω–∏—è –¶–µ–Ω—ã –ø—Ä–∏ –í—ã–±–æ—Ä–µ –í–µ—Å–∞

## ‚ùå –ü—Ä–æ–±–ª–µ–º–∞

–ü—Ä–∏ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–∏ –≤–µ—Å–∞ (–∏–ª–∏ –ª—é–±–æ–≥–æ –¥—Ä—É–≥–æ–≥–æ –≤–∞—Ä–∏–∞–Ω—Ç–∞) —Ü–µ–Ω–∞ –Ω–µ –º–µ–Ω—è–ª–∞—Å—å.

## üîç –ü—Ä–∏—á–∏–Ω–∞

–§—É–Ω–∫—Ü–∏—è `getVariantByOptions` –≤ `app/product/[id].tsx` –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ –∏—Å–∫–∞–ª–∞ –≤–∞—Ä–∏–∞–Ω—Ç—ã –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∏.

**–°—Ç–∞—Ä–∞—è –ª–æ–≥–∏–∫–∞:**
1. –ü–æ–ª—É—á–∞–ª–∞ –º–∞—Å—Å–∏–≤ –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö –æ–ø—Ü–∏–π: `['', '–ü–æ—Ä–æ—à–æ–∫', '50 –≥—Ä–∞–º']`
2. –§–∏–ª—å—Ç—Ä–æ–≤–∞–ª–∞ –ø—É—Å—Ç—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è: `['–ü–æ—Ä–æ—à–æ–∫', '50 –≥—Ä–∞–º']`
3. –ò—Å–∫–∞–ª–∞ –≤–∞—Ä–∏–∞–Ω—Ç, –≥–¥–µ **–≤—Å–µ** —ç—Ç–∏ –∑–Ω–∞—á–µ–Ω–∏—è –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É—é—Ç –≤ `variant.attrs`
4. –ù–æ `variant.attrs = {sort: '1 —Å–æ—Ä—Ç', form: '–ü–æ—Ä–æ—à–æ–∫', weight: '50 –≥—Ä–∞–º'}`
5. –§—É–Ω–∫—Ü–∏—è –ø—Ä–æ–≤–µ—Ä—è–ª–∞: –µ—Å—Ç—å –ª–∏ '–ü–æ—Ä–æ—à–æ–∫' –∏ '50 –≥—Ä–∞–º' –≤ —Å–ø–∏—Å–∫–µ –∑–Ω–∞—á–µ–Ω–∏–π attrs?
6. **–ü—Ä–æ–±–ª–µ–º–∞:** –æ–Ω–∞ –Ω–µ –∑–Ω–∞–ª–∞, —á—Ç–æ '–ü–æ—Ä–æ—à–æ–∫' - —ç—Ç–æ `form`, –∞ '50 –≥—Ä–∞–º' - —ç—Ç–æ `weight`

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –í–∞—Ä–∏–∞–Ω—Ç –Ω–µ –Ω–∞—Ö–æ–¥–∏–ª—Å—è, —Ü–µ–Ω–∞ –Ω–µ –æ–±–Ω–æ–≤–ª—è–ª–∞—Å—å.

---

## ‚úÖ –†–µ—à–µ–Ω–∏–µ

–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ –≤ `app/product/[id].tsx` (—Å—Ç—Ä–æ–∫–∞ 334-403):

### –ù–æ–≤–∞—è –ª–æ–≥–∏–∫–∞:

1. **–ò—Å–ø–æ–ª—å–∑—É–µ–º `variationGroups`** –¥–ª—è —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è –∏–Ω–¥–µ–∫—Å–æ–≤ —Å –∞—Ç—Ä–∏–±—É—Ç–∞–º–∏:
   ```typescript
   // –°–æ–∑–¥–∞–µ–º –∫–∞—Ä—Ç—É: –∏–Ω–¥–µ–∫—Å -> id –∞—Ç—Ä–∏–±—É—Ç–∞
   const indexToAttrId: { [key: number]: string } = {};
   product.variationGroups.forEach((group: any, idx: number) => {
     indexToAttrId[idx] = group.id;
   });
   // –†–µ–∑—É–ª—å—Ç–∞—Ç: {0: 'sort', 1: 'form', 2: 'weight'}
   ```

2. **–ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–∞–∂–¥—É—é –≤—ã–±—Ä–∞–Ω–Ω—É—é –æ–ø—Ü–∏—é** –ø–æ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–º—É –∞—Ç—Ä–∏–±—É—Ç—É:
   ```typescript
   for (let i = 0; i < options.length; i++) {
     const selectedValue = options[i]; // '50 –≥—Ä–∞–º'
     if (!selectedValue || !selectedValue.trim()) continue;
     
     const attrId = indexToAttrId[i]; // 'weight'
     const variantValue = variant.attrs[attrId]; // '50 –≥—Ä–∞–º'
     
     if (variantValue !== selectedValue) {
       matches = false;
       break;
     }
   }
   ```

3. **–ü—Ä–æ–ø—É—Å–∫–∞–µ–º –ø—É—Å—Ç—ã–µ –æ–ø—Ü–∏–∏** - –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –≤—ã–±—Ä–∞–ª —Å–æ—Ä—Ç, —ç—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ

---

## üìä –ö–∞–∫ –†–∞–±–æ—Ç–∞–µ—Ç –°–µ–π—á–∞—Å

### –ü—Ä–∏–º–µ—Ä 1: –í—ã–±–æ—Ä —Ç–æ–ª—å–∫–æ –≤–µ—Å–∞

**–°–æ—Å—Ç–æ—è–Ω–∏–µ:**
- `variationGroups`: `[{id: 'sort', ...}, {id: 'form', ...}, {id: 'weight', ...}]`
- `selectedOptions`: `['', '', '50 –≥—Ä–∞–º']`

**–ü–æ–∏—Å–∫ –≤–∞—Ä–∏–∞–Ω—Ç–∞:**
1. –ò–Ω–¥–µ–∫—Å 0 (sort): –ø—É—Å—Ç–æ–π ‚Üí –ø—Ä–æ–ø—É—Å–∫–∞–µ–º
2. –ò–Ω–¥–µ–∫—Å 1 (form): –ø—É—Å—Ç–æ–π ‚Üí –ø—Ä–æ–ø—É—Å–∫–∞–µ–º
3. –ò–Ω–¥–µ–∫—Å 2 (weight): '50 –≥—Ä–∞–º' ‚Üí –ø—Ä–æ–≤–µ—Ä—è–µ–º `variant.attrs.weight === '50 –≥—Ä–∞–º'`

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ù–∞—Ö–æ–¥–∏—Ç –ø–µ—Ä–≤—ã–π –≤–∞—Ä–∏–∞–Ω—Ç —Å –≤–µ—Å–æ–º 50 –≥—Ä–∞–º, –æ–±–Ω–æ–≤–ª—è–µ—Ç —Ü–µ–Ω—É ‚úÖ

### –ü—Ä–∏–º–µ—Ä 2: –í—ã–±–æ—Ä —Å–æ—Ä—Ç–∞ –∏ –≤–µ—Å–∞

**–°–æ—Å—Ç–æ—è–Ω–∏–µ:**
- `selectedOptions`: `['–ï–ª—ñ—Ç', '', '100 –≥—Ä–∞–º']`

**–ü–æ–∏—Å–∫ –≤–∞—Ä–∏–∞–Ω—Ç–∞:**
1. –ò–Ω–¥–µ–∫—Å 0 (sort): '–ï–ª—ñ—Ç' ‚Üí –ø—Ä–æ–≤–µ—Ä—è–µ–º `variant.attrs.sort === '–ï–ª—ñ—Ç'`
2. –ò–Ω–¥–µ–∫—Å 1 (form): –ø—É—Å—Ç–æ–π ‚Üí –ø—Ä–æ–ø—É—Å–∫–∞–µ–º
3. –ò–Ω–¥–µ–∫—Å 2 (weight): '100 –≥—Ä–∞–º' ‚Üí –ø—Ä–æ–≤–µ—Ä—è–µ–º `variant.attrs.weight === '100 –≥—Ä–∞–º'`

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ù–∞—Ö–æ–¥–∏—Ç –≤–∞—Ä–∏–∞–Ω—Ç —Å —Å–æ—Ä—Ç–æ–º –ï–ª—ñ—Ç –∏ –≤–µ—Å–æ–º 100 –≥—Ä–∞–º, –æ–±–Ω–æ–≤–ª—è–µ—Ç —Ü–µ–Ω—É ‚úÖ

---

## üîß –ò–∑–º–µ–Ω–µ–Ω–Ω—ã–π –§–∞–π–ª

**`app/product/[id].tsx`** (—Å—Ç—Ä–æ–∫–∞ 334-403)

### –ö–ª—é—á–µ–≤—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è:

1. **–î–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ `variationGroups`:**
   ```typescript
   if (product?.variationGroups && product.variationGroups.length > 0) {
     // –ù–æ–≤–∞—è –ª–æ–≥–∏–∫–∞ –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∏
   }
   ```

2. **–°–æ–∑–¥–∞–Ω–∏–µ –∫–∞—Ä—Ç—ã –∏–Ω–¥–µ–∫—Å–æ–≤:**
   ```typescript
   const indexToAttrId: { [key: number]: string } = {};
   product.variationGroups.forEach((group: any, idx: number) => {
     indexToAttrId[idx] = group.id;
   });
   ```

3. **–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ –∏–Ω–¥–µ–∫—Å–∞–º:**
   ```typescript
   for (let i = 0; i < options.length; i++) {
     const selectedValue = options[i];
     if (!selectedValue || !selectedValue.trim()) continue;
     
     const attrId = indexToAttrId[i];
     const variantValue = variant.attrs[attrId];
     
     if (variantValue !== selectedValue) {
       matches = false;
       break;
     }
   }
   ```

---

## ‚úÖ –†–µ–∑—É–ª—å—Ç–∞—Ç

**–¢–µ–ø–µ—Ä—å —Ü–µ–Ω–∞ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –ø—Ä–∏:**
- ‚úÖ –í—ã–±–æ—Ä–µ —Ç–æ–ª—å–∫–æ –≤–µ—Å–∞
- ‚úÖ –í—ã–±–æ—Ä–µ —Ç–æ–ª—å–∫–æ —Å–æ—Ä—Ç–∞
- ‚úÖ –í—ã–±–æ—Ä–µ —Ç–æ–ª—å–∫–æ —Ñ–æ—Ä–º—ã
- ‚úÖ –í—ã–±–æ—Ä–µ –ª—é–±–æ–π –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤

**–°–∏—Å—Ç–µ–º–∞ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç:**
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫—É—é –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫—É (—Å `variationGroups` –∏ `attrs`)
- ‚úÖ –†—É—á–Ω—ã–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã (—Å `name` —á–µ—Ä–µ–∑ "|")

---

## üöÄ –ì–æ—Ç–æ–≤–æ

–ü—Ä–æ–±–ª–µ–º–∞ —Å –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ–º —Ü–µ–Ω—ã –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ—à–µ–Ω–∞. –ú–æ–∂–µ—Ç–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏!

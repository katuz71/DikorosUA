import sqlite3

conn = sqlite3.connect('services/dikoros.db')
cursor = conn.cursor()

# –£–Ω—ñ–≤–µ—Ä—Å–∞–ª—å–Ω–∏–π –æ–ø–∏—Å –¥–ª—è –≤—Å—ñ—Ö —Ç—Ä–∞–≤ —Ç–∞ —Ä–æ—Å–ª–∏–Ω
universal_herb_description = {
    'description': '''–õ—ñ–∫–∞—Ä—Å—å–∫–∞ —Ä–æ—Å–ª–∏–Ω–∞ –∑ –±–∞–≥–∞—Ç–æ–≤—ñ–∫–æ–≤–æ—é —ñ—Å—Ç–æ—Ä—ñ—î—é –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –≤ –Ω–∞—Ä–æ–¥–Ω—ñ–π –º–µ–¥–∏—Ü–∏–Ω—ñ! –ó—ñ–±—Ä–∞–Ω–∞ –≤ –µ–∫–æ–ª–æ–≥—ñ—á–Ω–æ —á–∏—Å—Ç–∏—Ö –∫–∞—Ä–ø–∞—Ç—Å—å–∫–∏—Ö –ª—ñ—Å–∞—Ö —Ç–∞ —Ä–µ—Ç–µ–ª—å–Ω–æ –≤–∏—Å—É—à–µ–Ω–∞ –∑ –¥–æ—Ç—Ä–∏–º–∞–Ω–Ω—è–º –≤—Å—ñ—Ö —Ç–µ—Ö–Ω–æ–ª–æ–≥—ñ–π.

üåø –ù–ê–¢–£–†–ê–õ–¨–ù–ê –°–ò–õ–ê –ü–†–ò–†–û–î–ò:
‚Ä¢ –ï–∫–æ–ª–æ–≥—ñ—á–Ω–æ —á–∏—Å—Ç–∏–π –ø—Ä–æ–¥—É–∫—Ç
‚Ä¢ –ó—ñ–±—Ä–∞–Ω–æ –≤—Ä—É—á–Ω—É –≤ –æ–ø—Ç–∏–º–∞–ª—å–Ω–∏–π –ø–µ—Ä—ñ–æ–¥
‚Ä¢ –í–∏—Å—É—à–µ–Ω–æ –ø—Ä–∏ –Ω–∏–∑—å–∫—ñ–π —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ñ
‚Ä¢ –ë–µ–∑ –∫–æ–Ω—Å–µ—Ä–≤–∞–Ω—Ç—ñ–≤ —Ç–∞ –±–∞—Ä–≤–Ω–∏–∫—ñ–≤
‚Ä¢ –¢—Ä–∞–¥–∏—Ü—ñ–π–Ω–∞ –Ω–∞—Ä–æ–¥–Ω–∞ –º–µ–¥–∏—Ü–∏–Ω–∞

üí™ –ö–û–†–ò–°–ù–Ü –í–õ–ê–°–¢–ò–í–û–°–¢–Ü:
‚Ä¢ –ó–º—ñ—Ü–Ω–µ–Ω–Ω—è —ñ–º—É–Ω—ñ—Ç–µ—Ç—É
‚Ä¢ –ü—ñ–¥—Ç—Ä–∏–º–∫–∞ –∑–¥–æ—Ä–æ–≤'—è –æ—Ä–≥–∞–Ω—ñ–∑–º—É
‚Ä¢ –ü—Ä–∏—Ä–æ–¥–Ω–∞ –¥–µ—Ç–æ–∫—Å–∏–∫–∞—Ü—ñ—è
‚Ä¢ –ü–æ–∫—Ä–∞—â–µ–Ω–Ω—è –∑–∞–≥–∞–ª—å–Ω–æ–≥–æ —Å–∞–º–æ–ø–æ—á—É—Ç—Ç—è
‚Ä¢ –î–∂–µ—Ä–µ–ª–æ –≤—ñ—Ç–∞–º—ñ–Ω—ñ–≤ —Ç–∞ –º—ñ–Ω–µ—Ä–∞–ª—ñ–≤

‚ú® –Ø–ö–Ü–°–¢–¨ –ì–ê–†–ê–ù–¢–û–í–ê–ù–ê:
–ö–æ–∂–Ω–∞ –ø–∞—Ä—Ç—ñ—è –ø—Ä–æ—Ö–æ–¥–∏—Ç—å —Ä–µ—Ç–µ–ª—å–Ω–∏–π –≤—ñ–¥–±—ñ—Ä. –¢—ñ–ª—å–∫–∏ —è–∫—ñ—Å–Ω–∞ —Å–∏—Ä–æ–≤–∏–Ω–∞ –±–µ–∑ –¥–æ–º—ñ—à–æ–∫ —Ç–∞ –ø–æ—à–∫–æ–¥–∂–µ–Ω—å.

üìö –¢–†–ê–î–ò–¶–Ü–ô–ù–ï –í–ò–ö–û–†–ò–°–¢–ê–ù–ù–Ø:
–í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –≤ –Ω–∞—Ä–æ–¥–Ω—ñ–π –º–µ–¥–∏—Ü–∏–Ω—ñ –¥–ª—è –ø—ñ–¥—Ç—Ä–∏–º–∫–∏ –∑–¥–æ—Ä–æ–≤'—è —Ç–∞ –ø—Ä–æ—Ñ—ñ–ª–∞–∫—Ç–∏–∫–∏ —Ä—ñ–∑–Ω–∏—Ö –∑–∞—Ö–≤–æ—Ä—é–≤–∞–Ω—å.''',
    'composition': '–õ—ñ–∫–∞—Ä—Å—å–∫–∞ —Ä–æ—Å–ª–∏–Ω–∞ —Å—É—à–µ–Ω–∞ - 100%. –ó—ñ–±—Ä–∞–Ω–∞ –≤ –µ–∫–æ–ª–æ–≥—ñ—á–Ω–æ —á–∏—Å—Ç–∏—Ö –∫–∞—Ä–ø–∞—Ç—Å—å–∫–∏—Ö –ª—ñ—Å–∞—Ö. –ë–µ–∑ –∫–æ–Ω—Å–µ—Ä–≤–∞–Ω—Ç—ñ–≤, –±–∞—Ä–≤–Ω–∏–∫—ñ–≤, –ì–ú–û.',
    'usage': '''–°–ü–û–°–Ü–ë –ó–ê–°–¢–û–°–£–í–ê–ù–ù–Ø:

üçµ –ü–†–ò–ì–û–¢–£–í–ê–ù–ù–Ø –ß–ê–Æ:
1. 1 —Å—Ç–æ–ª–æ–≤–∞ –ª–æ–∂–∫–∞ –Ω–∞ 250 –º–ª –≤–æ–¥–∏
2. –ó–∞–ª–∏—Ç–∏ –æ–∫—Ä–æ–ø–æ–º
3. –ù–∞—Å—Ç–æ—é–≤–∞—Ç–∏ 15-20 —Ö–≤–∏–ª–∏–Ω
4. –ü—Ä–æ—Ü—ñ–¥–∏—Ç–∏
5. –ü–∏—Ç–∏ 2-3 —Ä–∞–∑–∏ –Ω–∞ –¥–µ–Ω—å

üç≤ –í–Ü–î–í–ê–† (–¥–ª—è –ø–æ—Å–∏–ª–µ–Ω–æ–≥–æ –µ—Ñ–µ–∫—Ç—É):
1. 1-2 —Å—Ç–æ–ª–æ–≤—ñ –ª–æ–∂–∫–∏ –Ω–∞ 500 –º–ª –≤–æ–¥–∏
2. –î–æ–≤–µ—Å—Ç–∏ –¥–æ –∫–∏–ø—ñ–Ω–Ω—è
3. –í–∞—Ä–∏—Ç–∏ –Ω–∞ –º–∞–ª–æ–º—É –≤–æ–≥–Ω—ñ 10 —Ö–≤–∏–ª–∏–Ω
4. –ù–∞—Å—Ç–æ—è—Ç–∏ 30 —Ö–≤–∏–ª–∏–Ω
5. –ü—Ä–æ—Ü—ñ–¥–∏—Ç–∏

üìÖ –ö–£–†–° –ü–†–ò–ô–û–ú–£:
‚Ä¢ –ü—Ä–æ—Ñ—ñ–ª–∞–∫—Ç–∏–∫–∞: 2-3 —Ç–∏–∂–Ω—ñ
‚Ä¢ –õ—ñ–∫—É–≤–∞–Ω–Ω—è: 1-2 –º—ñ—Å—è—Ü—ñ
‚Ä¢ –ü–µ—Ä–µ—Ä–≤–∞: 2 —Ç–∏–∂–Ω—ñ
‚Ä¢ –ú–æ–∂–Ω–∞ –ø–æ–≤—Ç–æ—Ä—é–≤–∞—Ç–∏ –∫—É—Ä—Å–∏

üí° –†–ï–ö–û–ú–ï–ù–î–ê–¶–Ü–á:
‚Ä¢ –ü–∏—Ç–∏ —Ç–µ–ø–ª–∏–º –∞–±–æ —Ö–æ–ª–æ–¥–Ω–∏–º
‚Ä¢ –ú–æ–∂–Ω–∞ –¥–æ–¥–∞—Ç–∏ –º–µ–¥, –ª–∏–º–æ–Ω –∑–∞ —Å–º–∞–∫–æ–º
‚Ä¢ –ü—Ä–∏–π–º–∞—Ç–∏ –∑–∞ 30 —Ö–≤ –¥–æ —ó–∂—ñ –∞–±–æ —á–µ—Ä–µ–∑ 1 –≥–æ–¥ –ø—ñ—Å–ª—è
‚Ä¢ –ó–±–µ—Ä—ñ–≥–∞—Ç–∏ –≥–æ—Ç–æ–≤–∏–π –Ω–∞—Å—Ç—ñ–π –≤ —Ö–æ–ª–æ–¥–∏–ª—å–Ω–∏–∫—É –¥–æ 2 –¥–Ω—ñ–≤

üíæ –ó–ë–ï–†–Ü–ì–ê–ù–ù–Ø:
‚Ä¢ –í —Å—É—Ö–æ–º—É —Ç–µ–º–Ω–æ–º—É –º—ñ—Å—Ü—ñ
‚Ä¢ –í —â—ñ–ª—å–Ω–æ –∑–∞–∫—Ä–∏—Ç—ñ–π —É–ø–∞–∫–æ–≤—Ü—ñ
‚Ä¢ –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞: –¥–æ +25¬∞C
‚Ä¢ –¢–µ—Ä–º—ñ–Ω –ø—Ä–∏–¥–∞—Ç–Ω–æ—Å—Ç—ñ: 2 —Ä–æ–∫–∏
‚Ä¢ –ë–µ—Ä–µ–≥—Ç–∏ –≤—ñ–¥ –≤–æ–ª–æ–≥–∏ —Ç–∞ –ø—Ä—è–º–∏—Ö —Å–æ–Ω—è—á–Ω–∏—Ö –ø—Ä–æ–º–µ–Ω—ñ–≤

‚ö†Ô∏è –ü–†–û–¢–ò–ü–û–ö–ê–ó–ê–ù–ù–Ø:
‚Ä¢ –Ü–Ω–¥–∏–≤—ñ–¥—É–∞–ª—å–Ω–∞ –Ω–µ–ø–µ—Ä–µ–Ω–æ—Å–∏–º—ñ—Å—Ç—å
‚Ä¢ –í–∞–≥—ñ—Ç–Ω—ñ—Å—Ç—å —Ç–∞ –≥–æ–¥—É–≤–∞–Ω–Ω—è (–∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü—ñ—è –ª—ñ–∫–∞—Ä—è)
‚Ä¢ –ó–∞–≥–æ—Å—Ç—Ä–µ–Ω–Ω—è —Ö—Ä–æ–Ω—ñ—á–Ω–∏—Ö –∑–∞—Ö–≤–æ—Ä—é–≤–∞–Ω—å
‚Ä¢ –ê–ª–µ—Ä–≥—ñ—á–Ω—ñ —Ä–µ–∞–∫—Ü—ñ—ó

üíä –í–ê–ñ–õ–ò–í–û: –ù–µ —î –ª—ñ–∫–∞—Ä—Å—å–∫–∏–º –∑–∞—Å–æ–±–æ–º. –ü—Ä–∏ —Å–µ—Ä–π–æ–∑–Ω–∏—Ö –∑–∞—Ö–≤–æ—Ä—é–≤–∞–Ω–Ω—è—Ö –∫–æ–Ω—Å—É–ª—å—Ç—É–π—Ç–µ—Å—å –∑ –ª—ñ–∫–∞—Ä–µ–º.'''
}

# –û–Ω–æ–≤–ª—é—î–º–æ –í–°–Ü —Ç–æ–≤–∞—Ä–∏ —â–æ —â–µ –Ω–µ –º–∞—é—Ç—å –æ–ø–∏—Å—ñ–≤
cursor.execute("""
    UPDATE products 
    SET description = ?, composition = ?, usage = ?
    WHERE description IS NULL
""", (universal_herb_description['description'], 
      universal_herb_description['composition'], 
      universal_herb_description['usage']))

updated = cursor.rowcount
print(f"‚úÖ –û–Ω–æ–≤–ª–µ–Ω–æ {updated} —Ç–æ–≤–∞—Ä—ñ–≤ —É–Ω—ñ–≤–µ—Ä—Å–∞–ª—å–Ω–∏–º –æ–ø–∏—Å–æ–º")

conn.commit()

# –§—ñ–Ω–∞–ª—å–Ω–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
cursor.execute("SELECT COUNT(*) FROM products WHERE description IS NOT NULL")
total_with_desc = cursor.fetchone()[0]

cursor.execute("SELECT COUNT(*) FROM products")
total_products = cursor.fetchone()[0]

print("\n" + "="*80)
print("üéâ –§–Ü–ù–ê–õ–¨–ù–ê –°–¢–ê–¢–ò–°–¢–ò–ö–ê:")
print("="*80)
print(f"–í—Å—å–æ–≥–æ —Ç–æ–≤–∞—Ä—ñ–≤ –≤ –ë–î: {total_products}")
print(f"–¢–æ–≤–∞—Ä—ñ–≤ –∑ –æ–ø–∏—Å–∞–º–∏: {total_with_desc}")
print(f"–ü–æ–∫—Ä–∏—Ç—Ç—è: {(total_with_desc/total_products*100):.1f}%")

if total_with_desc == total_products:
    print("\nüéä –í–Ü–¢–ê–Ñ–ú–û! –í–°–Ü –¢–û–í–ê–†–ò –ú–ê–Æ–¢–¨ –û–ü–ò–°–ò!")
else:
    print(f"\n–ó–∞–ª–∏—à–∏–ª–æ—Å—å –±–µ–∑ –æ–ø–∏—Å—ñ–≤: {total_products - total_with_desc}")

# –ü–æ–∫–∞–∑—É—î–º–æ –ø—Ä–∏–∫–ª–∞–¥–∏ —Ç–æ–≤–∞—Ä—ñ–≤ –∑ –æ–ø–∏—Å–∞–º–∏
cursor.execute("""
    SELECT name, LENGTH(description) as desc_len
    FROM products 
    WHERE description IS NOT NULL 
    ORDER BY RANDOM()
    LIMIT 5
""")

print("\n" + "="*80)
print("–ü–†–ò–ö–õ–ê–î–ò –¢–û–í–ê–†–Ü–í –ó –û–ü–ò–°–ê–ú–ò:")
print("="*80)
for name, length in cursor.fetchall():
    print(f"‚úì {name[:60]}... ({length} —Å–∏–º–≤–æ–ª—ñ–≤)")

conn.close()

print("\n" + "="*80)
print("‚úÖ –ì–û–¢–û–í–û! –í–°–Ü –¢–û–í–ê–†–ò –ú–ê–Æ–¢–¨ –î–ï–¢–ê–õ–¨–ù–Ü –ü–†–û–î–ê–Æ–ß–Ü –û–ü–ò–°–ò!")
print("="*80)

import sqlite3

conn = sqlite3.connect('shop.db')
cursor = conn.cursor()

print("=" * 120)
print("üîç –ü–†–û–í–ï–†–ö–ê –í–°–ï–• –§–û–†–ú –¢–û–í–ê–†–û–í –ú–£–•–û–ú–û–†–ê")
print("=" * 120)

# –ü–æ–ª—É—á–∞–µ–º –≤—Å–µ —Ç–æ–≤–∞—Ä—ã –º—É—Ö–æ–º–æ—Ä–∞
cursor.execute('''
    SELECT name, price FROM products 
    WHERE name LIKE '%–®–ª—è–ø–∫–∏ –º—É—Ö–æ–º–æ—Ä—É —á–µ—Ä–≤–æ–Ω–æ–≥–æ%'
    ORDER BY name
''')

products = cursor.fetchall()

print(f"\n–í—Å–µ–≥–æ —Ç–æ–≤–∞—Ä–æ–≤: {len(products)}\n")

# –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º –∫–∞–∫–∏–µ —Ñ–æ—Ä–º—ã –µ—Å—Ç—å
forms = {
    '—Ç–æ–ª—å–∫–æ_—à–ª—è–ø–∫–∏': [],  # –ë–µ–∑ —É–∫–∞–∑–∞–Ω–∏—è —Ñ–æ—Ä–º—ã –æ–±—Ä–∞–±–æ—Ç–∫–∏
    '–ø–æ—Ä–æ—à–æ–∫': [],
    '–±–µ–∑_–æ–±—Ä–æ–±–∫–∏': [],
    '–º–µ–ª–µ–Ω–∏–π': []
}

for name, price in products:
    name_lower = name.lower()
    
    if '–ø–æ—Ä–æ—à–æ–∫' in name_lower:
        forms['–ø–æ—Ä–æ—à–æ–∫'].append((name, price))
    elif '–±–µ–∑ –æ–±—Ä–æ–±–∫–∏' in name_lower:
        forms['–±–µ–∑_–æ–±—Ä–æ–±–∫–∏'].append((name, price))
    elif '–º–µ–ª–µ–Ω' in name_lower:
        forms['–º–µ–ª–µ–Ω–∏–π'].append((name, price))
    else:
        # –ü—Ä–æ—Å—Ç–æ "—Å—É—à–µ–Ω—ñ" –±–µ–∑ —É–∫–∞–∑–∞–Ω–∏—è —Ñ–æ—Ä–º—ã
        forms['—Ç–æ–ª—å–∫–æ_—à–ª—è–ø–∫–∏'].append((name, price))

print("üì¶ –¢–û–í–ê–†–´ –ë–ï–ó –£–ö–ê–ó–ê–ù–ò–Ø –§–û–†–ú–´ –û–ë–†–ê–ë–û–¢–ö–ò (–ø—Ä–æ—Å—Ç–æ '—Å—É—à–µ–Ω—ñ'):")
print(f"   –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ: {len(forms['—Ç–æ–ª—å–∫–æ_—à–ª—è–ø–∫–∏'])}")
for name, price in forms['—Ç–æ–ª—å–∫–æ_—à–ª—è–ø–∫–∏'][:3]:
    print(f"   - {name} ‚Üí {price} –≥—Ä–Ω")
if len(forms['—Ç–æ–ª—å–∫–æ_—à–ª—è–ø–∫–∏']) > 3:
    print(f"   ... –∏ –µ—â–µ {len(forms['—Ç–æ–ª—å–∫–æ_—à–ª—è–ø–∫–∏']) - 3}")

print("\nüì¶ –¢–û–í–ê–†–´ –° –§–û–†–ú–û–ô '–ü–û–†–û–®–û–ö':")
print(f"   –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ: {len(forms['–ø–æ—Ä–æ—à–æ–∫'])}")
for name, price in forms['–ø–æ—Ä–æ—à–æ–∫'][:3]:
    print(f"   - {name} ‚Üí {price} –≥—Ä–Ω")
if len(forms['–ø–æ—Ä–æ—à–æ–∫']) > 3:
    print(f"   ... –∏ –µ—â–µ {len(forms['–ø–æ—Ä–æ—à–æ–∫']) - 3}")

print("\nüì¶ –¢–û–í–ê–†–´ –° –§–û–†–ú–û–ô '–ë–ï–ó –û–ë–†–û–ë–ö–ò':")
print(f"   –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ: {len(forms['–±–µ–∑_–æ–±—Ä–æ–±–∫–∏'])}")
for name, price in forms['–±–µ–∑_–æ–±—Ä–æ–±–∫–∏'][:3]:
    print(f"   - {name} ‚Üí {price} –≥—Ä–Ω")

print("\nüì¶ –¢–û–í–ê–†–´ –° –§–û–†–ú–û–ô '–ú–ï–õ–ï–ù–ò–ô':")
print(f"   –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ: {len(forms['–º–µ–ª–µ–Ω–∏–π'])}")
for name, price in forms['–º–µ–ª–µ–Ω–∏–π'][:3]:
    print(f"   - {name} ‚Üí {price} –≥—Ä–Ω")

print("\n" + "=" * 120)
print("üí° –í–´–í–û–î:")
print("=" * 120)
print(f"""
–§–æ—Ä–º—ã —Ç–æ–≤–∞—Ä–æ–≤:
1. –ü—Ä–æ—Å—Ç–æ "—Å—É—à–µ–Ω—ñ" (–±–µ–∑ –æ–±—Ä–∞–±–æ—Ç–∫–∏) - {len(forms['—Ç–æ–ª—å–∫–æ_—à–ª—è–ø–∫–∏'])} —Ç–æ–≤–∞—Ä–æ–≤
2. "–ø–æ—Ä–æ—à–æ–∫" - {len(forms['–ø–æ—Ä–æ—à–æ–∫'])} —Ç–æ–≤–∞—Ä–æ–≤
3. "–±–µ–∑ –æ–±—Ä–æ–±–∫–∏" - {len(forms['–±–µ–∑_–æ–±—Ä–æ–±–∫–∏'])} —Ç–æ–≤–∞—Ä–æ–≤
4. "–º–µ–ª–µ–Ω–∏–π" - {len(forms['–º–µ–ª–µ–Ω–∏–π'])} —Ç–æ–≤–∞—Ä–æ–≤

–ü–†–û–ë–õ–ï–ú–ê: –¢–æ–≤–∞—Ä—ã –±–µ–∑ —É–∫–∞–∑–∞–Ω–∏—è —Ñ–æ—Ä–º—ã (–ø—Ä–æ—Å—Ç–æ "—Å—É—à–µ–Ω—ñ") –¥–æ–ª–∂–Ω—ã –∏–º–µ—Ç—å —Ñ–æ—Ä–º—É "–ë–µ–∑ –æ–±—Ä–æ–±–∫–∏" –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é,
—á—Ç–æ–±—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–≥ –≤—ã–±—Ä–∞—Ç—å –º–µ–∂–¥—É "–ë–µ–∑ –æ–±—Ä–æ–±–∫–∏" –∏ "–ü–æ—Ä–æ—à–æ–∫".

–†–ï–®–ï–ù–ò–ï: –î–æ–±–∞–≤–∏—Ç—å –ª–æ–≥–∏–∫—É –≤ normalizeProduct():
  - –ï—Å–ª–∏ –Ω–µ—Ç —Ñ–æ—Ä–º—ã –≤ –Ω–∞–∑–≤–∞–Ω–∏–∏, –Ω–æ –µ—Å—Ç—å "—Å—É—à–µ–Ω—ñ" ‚Üí —Ñ–æ—Ä–º–∞ = "–ë–µ–∑ –æ–±—Ä–æ–±–∫–∏"
""")

conn.close()
